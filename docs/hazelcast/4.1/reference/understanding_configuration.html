<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Understanding Configuration Hazelcast Documentation</title>
    <link rel="canonical" href="https://jakescahill.github.io/docs-poc/hazelcast/4.1/reference/understanding_configuration.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-M267KFN"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','GTM-M267KFN')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://jakescahill.github.io/docs-poc">Hazelcast Documentation</a>
          <div class="navbar-item">
            <input id="search-input" type="text" placeholder="Search docs">
          </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Hazelcast Cloud</a>
            <a class="navbar-item" href="https://jakescahill.github.io/docs-poc/hazelcast/4.1/index.html">Hazelcast IMDG</a>
            <a class="navbar-item" href="#">Hazelcast Jet</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Learn</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://jakescahill.github.io/docs-poc/home/index.html">Docs</a>
            <a class="navbar-item" href="https://training.hazelcast.com/">Online Training</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Demos</a>
            <a class="navbar-item" href="#">Community</a>
            <a class="navbar-item" href="#">Blog</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Get Hazelcast</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="hazelcast" data-version="4.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../hazelcast_overview.html">Hazelcast IMDG</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../hazelcast_overview.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../get-started/getting_started.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-started/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../develop/hazelcast_clients.html">Develop Solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/jcache.html">JCache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/performance.html">Performance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/serialization.html">Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/striim_cdc.html">Striim Hot Cache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_query.html">Distributed Query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_sql.html">Distributed SQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_events.html">Distributed Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_computing.html">Distributed Computing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploy/installing_upgrading.html">Deploy Clusters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/starting_members_clients.html">Starting Members and Clients</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/setting_up_clusters.html">Setting Up Clusters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/management.html">Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/simulator.html">Hazelcast Simulator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/wan.html">WAN Replication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/network_partitioning.html">Network Partitioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate/migration_guides.html">Migrate</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshoot/common_exception_types.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="faq.html">Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dds.html">Distributed data structures</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="system_properties.html">System properties</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="understanding_configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="phone_homes.html">Phone homes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="hazelcast_plugins.html">Plugins</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../contribute/extending_hazelcast.html">Contribute</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/licenses.html">Licenses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/revision_history.html">Documentation changes</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Hazelcast IMDG</span>
    <span class="version">4.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Hazelcast IMDG</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../hazelcast_overview.html">4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Home</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../home/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../hazelcast_overview.html">Hazelcast IMDG</a></li>
    <li><a href="faq.html">Reference</a></li>
    <li><a href="understanding_configuration.html">Configuration</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a class="git" href="file:///C:/Users/Jake%20Cahill/Documents/code-playground/docs/hazelcast-docs/modules/reference/pages/understanding_configuration.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Understanding Configuration</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the options to configure your Hazelcast applications
and explains the utilities which you can make use of while configuring.
You can configure Hazelcast using one or mix of the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declarative way</p>
</li>
<li>
<p>Programmatic way</p>
</li>
<li>
<p>Using Hazelcast system properties</p>
</li>
<li>
<p>Within the Spring context</p>
</li>
<li>
<p>Overriding configuration with environment variables or system properties</p>
</li>
<li>
<p>Dynamically adding configuration on a running cluster</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-declaratively"><a class="anchor" href="#configuring-declaratively"></a>Configuring Declaratively</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is the configuration option where you use an XML or a YAML configuration
file. When you download and unzip <code>hazelcast-4.1
.zip</code>, you see the following files present in the  <code>/bin</code> folder, which are
standard configuration files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast-default.xml</code>: Default declarative XML configuration file for Hazelcast.
The configuration for the distributed data structures in this XML file should
be fine for most of the Hazelcast users. If not, you can tailor this XML file according
to your needs by adding/removing/modifying properties. Also see the <a href="#setting-up-clusters">Setting Up Clusters chapter</a> for the network related configurations.</p>
</li>
<li>
<p><code>hazelcast-default.yaml</code>: Default YAML configuration file identical to <code>hazelcast.xml</code> in content.</p>
</li>
<li>
<p><code>hazelcast-full-example.xml</code>: Configuration file which includes all Hazelcast configuration
elements and attributes with their descriptions. It is the "superset" of <code>hazelcast.xml</code>.
You can use <code>hazelcast-full-example.xml</code> as a reference document to learn about any element
or attribute, or you can change its name to <code>hazelcast.xml</code> and start to use it as your
Hazelcast configuration file.</p>
</li>
<li>
<p><code>hazelcast-full-example.yaml</code>: YAML configuration file identical to
<code>hazelcast-full-example.xml</code> in content.</p>
</li>
<li>
<p><code>hazelcast-client-full-example.xml</code>: Complete Hazelcast Java client example configuration
file which includes all configuration elements and attributes with their descriptions. Read
more about Java client configuration <a href="#configuring-java-client">here</a>.</p>
</li>
<li>
<p><code>hazelcast-client-full-example.yaml</code>: YAML configuration file identical to
<code>hazelcast-client-full-example.xml</code> in content.</p>
</li>
<li>
<p><code>hazelcast-client-failover-full-example.xml</code>: Complete Hazelcast client failover example
configuration file which includes all Hazelcast client failover configuration elements and
attributes with their descriptions. Read about Blue-Green Deployment and Disaster Recovery
<a href="#blue-green-deployment-and-disaster-recovery">here</a>.</p>
</li>
<li>
<p><code>hazelcast-client-failover-full-example.yaml</code>: YAML configuration file identical to
<code>hazelcast-client-failover-full-example.xml</code> in content.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A part of the default XML/YAML configurations is shown as an example below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;cluster-name&gt;dev&lt;/cluster-name&gt;
    &lt;management-center scripting-enabled="false" /&gt;
    &lt;network&gt;
        &lt;port auto-increment="true" port-count="100"&gt;5701&lt;/port&gt;
        &lt;outbound-ports&gt;
        &lt;!--
        Allowed port range when connecting to other members.
        0 or * means the port provided by the system.
        --&gt;
            &lt;ports&gt;0&lt;/ports&gt;
        &lt;/outbound-ports&gt;
        &lt;join&gt;
            &lt;multicast enabled="true"&gt;
                &lt;multicast-group&gt;224.2.2.3&lt;/multicast-group&gt;
                &lt;multicast-port&gt;54327&lt;/multicast-port&gt;
	    &lt;/multicast&gt;
	    &lt;tcp-ip enabled="false"&gt;
	        &lt;interface&gt;127.0.0.1&lt;/interface&gt;
                &lt;member-list&gt;
                    &lt;member&gt;127.0.0.1&lt;/member&gt;
                &lt;/member-list&gt;
            &lt;/tcp-ip&gt;
        &lt;/join&gt;
    &lt;/network&gt;
    &lt;map name="default"&gt;
        &lt;time-to-live-seconds&gt;0&lt;/time-to-live-seconds&gt;
    &lt;/map&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  ...
  cluster-name: dev
  management-center:
    scripting-enabled: false
  network:
    port:
      auto-increment: true
      port-count: 100
      port: 5701
    outbound-ports:
      # Allowed port range when connecting to other nodes.
      # 0 or * means use system provided port.
      - 0
    join:
      multicast:
        enabled: true
        multicast-group: 224.2.2.3
        multicast-port: 54327
      tcp-ip:
        enabled: false
        interface: 127.0.0.1
        member-list:
          - 127.0.0.1
  map:
    default:
      time-to-live-seconds: 0
    ...</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="composing-declarative-configuration"><a class="anchor" href="#composing-declarative-configuration"></a>Composing Declarative Configuration</h3>
<div class="paragraph">
<p>You can compose the declarative configuration of your Hazelcast member or
Hazelcast client from multiple declarative
configuration snippets. In order to compose a declarative configuration, you
can <code>import</code> different
declarative configuration files. Composing configuration files is supported both
in XML and YAML configurations with the
limitation that only configuration files written in the same language can be composed.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s say you want to compose the declarative configuration for Hazelcast out of two
XML configurations: <code>development-cluster-config.xml</code> and <code>development-network-config.xml</code>.
These two configurations are shown below.</p>
</div>
<div class="paragraph">
<p><code>development-cluster-config.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;cluster-name&gt;dev&lt;/cluster-name&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>development-network-config.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;network&gt;
        &lt;port auto-increment="true" port-count="100"&gt;5701&lt;/port&gt;
        &lt;join&gt;
            &lt;multicast enabled="true"&gt;
                &lt;multicast-group&gt;224.2.2.3&lt;/multicast-group&gt;
                &lt;multicast-port&gt;54327&lt;/multicast-port&gt;
            &lt;/multicast&gt;
        &lt;/join&gt;
    &lt;/network&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get your example Hazelcast declarative configuration out of the above two,
use the <code>&lt;import/&gt;</code> element as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;import resource="development-group-config.xml"/&gt;
    &lt;import resource="development-network-config.xml"/&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example using the YAML configuration files looks like the following:</p>
</div>
<div class="paragraph">
<p><code>development-cluster-config.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  cluster-name: dev</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>development-network-config.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  network:
    port:
      auto-increment: true
      port-count: 100
      port: 5701
    join:
      multicast:
        enabled: true
        multicast-group: 224.2.2.3
        multicast-port: 54327</code></pre>
</div>
</div>
<div class="paragraph">
<p>Composing the above two YAML configuration files needs them to be imported as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  import:
    - development-group-config.yaml
    - development-network-config.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This feature also applies to the declarative configuration of Hazelcast client.
See the following examples.</p>
</div>
<div class="paragraph">
<p><code>client-cluster-config.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast-client&gt;
    &lt;cluster-name&gt;dev&lt;/cluster-name&gt;
&lt;/hazelcast-client&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>client-network-config.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast-client&gt;
    &lt;network&gt;
        &lt;cluster-members&gt;
            &lt;address&gt;127.0.0.1:7000&lt;/address&gt;
        &lt;/cluster-members&gt;
    &lt;/network&gt;
&lt;/hazelcast-client&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get a Hazelcast client declarative configuration from the above two examples,
use the <code>&lt;import/&gt;</code> element as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast-client&gt;
    &lt;import resource="client-cluster-config.xml"/&gt;
    &lt;import resource="client-network-config.xml"/&gt;
&lt;/hazelcast-client&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same client configuration using the YAML language is shown below.</p>
</div>
<div class="paragraph">
<p><code>client-cluster-config.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast-client:
  cluster-name: dev</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>client-network-config.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast-client:
  network:
    cluster-members:
      - 127.0.0.1:7000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Composing a Hazelcast client declarative configuration by importing the above two examples is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast-client:
  import:
    - client-cluster-config.yaml
    - client-network-config.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use <code>&lt;import/&gt;</code> element on top level of the XML hierarchy.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use the <code>import</code> mapping on top level of the YAML hierarchy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Resources from the classpath and file system may also be used to compose a declarative configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;import resource="file:///etc/hazelcast/development-cluster-config.xml"/&gt; &lt;!-- loaded from filesystem --&gt;
    &lt;import resource="classpath:development-network-config.xml"/&gt;  &lt;!-- loaded from classpath --&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  import:
    # loaded from filesystem
    - file:///etc/hazelcast/development-cluster-config.yaml
    # loaded from classpath
    - classpath:development-network-config.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Importing resources with variables in their names is also supported. See the following example snippets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;import resource="${environment}-cluster-config.xml"/&gt;
    &lt;import resource="${environment}-network-config.xml"/&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  import:
    - ${environment}-cluster-config.yaml
    - ${environment}-network-config.yaml</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the <a href="#using-variables">Using Variables section</a> to learn how you can set
the configuration elements with variables.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="configuring-declaratively-yaml"><a class="anchor" href="#configuring-declaratively-yaml"></a>Configuring Declaratively with YAML</h3>
<div class="paragraph">
<p>You can configure the Hazelcast members and Java clients declaratively with YAML configuration files in
installations of Hazelcast running on Java runtime version 8 or above.</p>
</div>
<div class="paragraph">
<p>The structure of the YAML configuration follows the structure of the XML configuration.
Therefore, you can rewrite the existing XML
configurations in YAML easily. There are some differences between the XML and YAML languages
that make the two declarative configurations to slightly derive as the the following examples show.</p>
</div>
<div class="paragraph">
<p>In the YAML declarative configuration, mappings are used in which the name of the mapping node
needs to be unique within its enclosing mapping. See the following example with
configuring two maps in the same configuration file.</p>
</div>
<div class="paragraph">
<p>In the XML configuration files, we have two <code>&lt;map&gt;</code> elements as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;map name="map1"&gt;
        &lt;!-- map1 configuration --&gt;
    &lt;/map&gt;
    &lt;map name="map2"&gt;
        &lt;!-- map2 configuration --&gt;
    &lt;/map&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the YAML configuration, the map can be configured under a mapping <code>map</code> as shown in
the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
    ...
    map:
        map1:
          # map1 configuration
        map2:
          # map2 configuration
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The XML and YAML configurations above define the same maps <code>map1</code> and <code>map2</code>.
Please note that in the YAML configuration file
there is no <code>name</code> node, instead, the name of the map is used as the name of the
mapping for configuring the given map.</p>
</div>
<div class="paragraph">
<p>There are other configuration entries that have no unique names and are listed in the
same enclosing entry. Examples to this
kind of configurations are listing the member addresses, interfaces in the networking
configurations and defining listeners. The
following example configures listeners to illustrate this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;listeners&gt;
        &lt;listener&gt;com.hazelcast.examples.MembershipListener&lt;/listener&gt;
        &lt;listener&gt;com.hazelcast.examples.MigrationListener&lt;/listener&gt;
        &lt;listener&gt;com.hazelcast.examples.PartitionLostListener&lt;/listener&gt;
    &lt;/listeners&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the YAML configuration, the listeners are defined as a sequence.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  ...
  listeners:
    - com.hazelcast.examples.MembershipListener
    - com.hazelcast.examples.MigrationListener
    - com.hazelcast.examples.PartitionLostListener
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another notable difference between XML and YAML is the lack of the attributes in the
case of YAML. Everything that can be
configured with an attribute in the XML configuration is a scalar node in the YAML
configuration with the same name. See the
following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;network&gt;
        &lt;join&gt;
            &lt;multicast enabled="true"&gt;
                &lt;multicast-group&gt;1.2.3.4&lt;/multicast-group&gt;
                &lt;!-- other multicast configuration options --&gt;
            &lt;/multicast&gt;
        &lt;/join&gt;
    &lt;/network&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the identical YAML configuration, the <code>enabled</code> attribute of the XML
configuration is a scalar node on the same level with
the other items of the multicast configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  ...
  network:
    join:
      multicast:
        enabled: true
        multicast-group: 1.2.3.4
        # other multicast configuration options
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can refer to the full example YAML configuration files placed in the <code>/bin</code> folder
of the downloadable <code>hazelcast-4.1.zip</code> after unzipping it. Please see the
complete list of the full example YAML configurations <a href="#configuring-declaratively">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-programmatically"><a class="anchor" href="#configuring-programmatically"></a>Configuring Programmatically</h3>
<div class="paragraph">
<p>Besides declarative configuration, you can configure your cluster programmatically.
For this you can create a <code>Config</code> object, set/change its properties and attributes
and use this <code>Config</code> object to create a new Hazelcast member. Following is an example
code which configures some network and Hazelcast Map properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        Config config = new Config();
        config.getNetworkConfig().setPort( 5900 )
                .setPortAutoIncrement( false );

        MapConfig mapConfig = new MapConfig();
        mapConfig.setName( "testMap" )
                .setBackupCount( 2 )
                .setTimeToLiveSeconds( 300 );</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a Hazelcast member with the above example configuration, pass the
configuration object as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>HazelcastInstance hazelcast = Hazelcast.newHazelcastInstance( config );</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>Config</code> must not be modified after the Hazelcast instance is started.
In other words, all configuration must be completed before creating the <code>HazelcastInstance</code>.
Certain additional configuration elements can be added at runtime as described in the
<a href="#dynamically-adding-data-structure-configuration-on-a-cluster">Dynamically Adding Data Structure Configuration on a Cluster section</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also create a named Hazelcast member. In this case, you should set <code>instanceName</code>
of <code>Config</code> object as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config();
config.setInstanceName( "my-instance" );
Hazelcast.newHazelcastInstance( config );</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve an existing Hazelcast member by its name, use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Hazelcast.getHazelcastInstanceByName( "my-instance" );</code></pre>
</div>
</div>
<div class="paragraph">
<p>To retrieve all existing Hazelcast members, use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Hazelcast.getAllHazelcastInstances();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Hazelcast performs schema validation through the file <code>hazelcast-config-4.1.xsd</code>
which comes with your Hazelcast libraries. Hazelcast throws a meaningful exception if there
is an error in the declarative or programmatic configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to specify your own configuration file to create <code>Config</code>, Hazelcast supports
several ways including filesystem,
classpath, InputStream and URL.</p>
</div>
<div class="paragraph">
<p>Building <code>Config</code> from the XML declarative configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Config cfg = new XmlConfigBuilder(xmlFileName).build();</code></p>
</li>
<li>
<p><code>Config cfg = new XmlConfigBuilder(inputStream).build();</code></p>
</li>
<li>
<p><code>Config cfg = new ClasspathXmlConfig(xmlFileName);</code></p>
</li>
<li>
<p><code>Config cfg = new FileSystemXmlConfig(configFilename);</code></p>
</li>
<li>
<p><code>Config cfg = new UrlXmlConfig(url);</code></p>
</li>
<li>
<p><code>Config cfg = new InMemoryXmlConfig(xml);</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Building <code>Config</code> from the YAML declarative configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Config cfg = new YamlConfigBuilder(yamlFileName).build();</code></p>
</li>
<li>
<p><code>Config cfg = new YamlConfigBuilder(inputStream).build();</code></p>
</li>
<li>
<p><code>Config cfg = new ClasspathYamlConfig(yamlFileName);</code></p>
</li>
<li>
<p><code>Config cfg = new FileSystemYamlConfig(configFilename);</code></p>
</li>
<li>
<p><code>Config cfg = new UrlYamlConfig(url);</code></p>
</li>
<li>
<p><code>Config cfg = new InMemoryYamlConfig(yaml);</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-with-system-properties"><a class="anchor" href="#configuring-with-system-properties"></a>Configuring with System Properties</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use system properties to configure some aspects of Hazelcast. You set
these properties as name and value pairs through declarative configuration,
programmatic configuration or JVM system property. Following are examples for
each option.</p>
</div>
<div class="paragraph">
<p><strong>Declarative Configuration:</strong></p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;properties&gt;
        &lt;property name="hazelcast.property.foo"&gt;value&lt;/property&gt;
    &lt;/properties&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
    ...
    properties:
      hazelcast.property.foo: value
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic Configuration:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config() ;
config.setProperty( "hazelcast.property.foo", "value" );</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Using JVM&#8217;s <code>System</code> class or <code>-D</code> argument:</strong></p>
</div>
<div class="paragraph">
<p><code>System.setProperty( "hazelcast.property.foo", "value" );</code></p>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p><code>java -Dhazelcast.property.foo=value</code></p>
</div>
<div class="paragraph">
<p>You will see Hazelcast system properties mentioned throughout this Reference Manual
as required in some of the chapters and sections. All Hazelcast system properties
are listed in the <a href="#system-properties">System Properties appendix</a> with their
descriptions, default values and property types as a reference for you.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-within-spring-context"><a class="anchor" href="#configuring-within-spring-context"></a>Configuring within Spring Context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use Hazelcast with <a href="https://spring.io/" target="_blank" rel="noopener">Spring</a> you can declare beans
using the namespace <code>hazelcast</code>. When you add the namespace declaration to
the element <code>beans</code> in the Spring context file, you can start to use the
namespace shortcut <code>hz</code> to be used as a bean declaration. Following is an
example Hazelcast configuration when integrated with Spring:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hz:hazelcast id="instance"&gt;
    &lt;hz:config&gt;
        &lt;hz:cluster-name name="dev"/&gt;
        &lt;hz:network port="5701" port-auto-increment="false"&gt;
            &lt;hz:join&gt;
                &lt;hz:multicast enabled="false"/&gt;
                &lt;hz:tcp-ip enabled="true"&gt;
                    &lt;hz:members&gt;10.10.1.2, 10.10.1.3&lt;/hz:members&gt;
                &lt;/hz:tcp-ip&gt;
            &lt;/hz:join&gt;
        &lt;/hz:network&gt;
    &lt;/hz:config&gt;
&lt;/hz:hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#integration-with-spring">Integration with Spring section</a> for
more information on Hazelcast-Spring integration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overriding-configuration"><a class="anchor" href="#overriding-configuration"></a>Overriding Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can override your clusters' configurations
without having to modify the XML or YAML configuration files.
Hazelcast makes this possible using the system properties or
environment variables.</p>
</div>
<div class="paragraph">
<p>For example, if you just want to override <code>cluster-name</code>,
you would need to craft a declarative configuration as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;cluster-name name="dev"/&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  cluster-name: dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of the above, you can achieve the same purpose using
the following on the command line:</p>
</div>
<div class="listingblock primary">
<div class="title">Using Environment Variable</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">export HZ_CLUSTERNAME=dev</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Using System Property</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">java -Dhz.cluster-name=value</code></pre>
</div>
</div>
<div class="paragraph">
<p>Recognized and unrecognized configuration entries will be logged when Hazelcast starts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above mechanism exists mostly for the sake of trivial
environment specific configuration changes, and should not be treated
as a replacement for complex XML/YAML configuration files.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_conversion_rules"><a class="anchor" href="#_conversion_rules"></a>Conversion Rules</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All entries need to mirror YAML configuration structure which differs slightly from XML&#8217;s.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to make Hazelcast recognize environment variables
as valid configuration entries, they need to obey the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each configuration entry needs to start with <code>HZ_</code> or <code>HZ_CLIENT_</code>.</p>
</li>
<li>
<p>A new configuration level should be introduced with an underscore (<code>_</code>).</p>
</li>
<li>
<p>Dashes (<code>-</code>) should be removed.</p>
</li>
<li>
<p>Variable names should be in upper case.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assume that you want to have the following configuration for
your cluster, represented as YAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">hazelcast:
  cluster-name: dev
  network:
    port:
      auto-increment: true
      port-count: 100
      port: 5701
    join:
      auto-detection:
        enabled: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to use the environment variables, the above
would be represented as a set of the following environment variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">HZ_CLUSTERNAME=dev
HZ_NETWORK_PORT_AUTOINCREMENT=true
HZ_NETWORK_PORT_PORTCOUNT=100
HZ_NETWORK_PORT_PORT=5701
HZ_NETWORK_JOIN_AUTODETECTION_ENABLED=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to make Hazelcast recognize system properties
as valid configuration entries, they need to obey the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each configuration entry needs to start with <code>hz.</code> or <code>hz-client.</code>.</p>
</li>
<li>
<p>A new configuration level should be introduced with an underscore (<code>_</code>).</p>
</li>
<li>
<p>Variable names should be in lower case.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to use the environment variables, the above YAML
configuration would be represented as a set of the following system
properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-plain hljs" data-lang="plain">hz.cluster-name=dev
hz.network.port.auto-increment=true
hz.network.port_port-count=100
hz.network.port_port=5701
hz.network.join-auto-detection-enabled=true</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Keep in mind that it&#8217;s not possible to override
configuration entries using YAML sequences.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamically-adding-data-structure-configuration-on-a-cluster"><a class="anchor" href="#dynamically-adding-data-structure-configuration-on-a-cluster"></a>Dynamically Adding Data Structure Configuration on a Cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As described above, Hazelcast can be configured in a declarative or
programmatic way; configuration must be completed before starting a
Hazelcast member and this configuration cannot be altered at runtime,
thus we refer to this as <em>static</em> configuration.</p>
</div>
<div class="paragraph">
<p>It is possible to dynamically add configuration for certain data structures at
runtime; these can be added by invoking one of the <code>Config.add*Config</code> methods on
the <code>Config</code> object obtained from a running member&#8217;s <code>HazelcastInstance.getConfig()</code> method.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">        Config config = new Config();
        MapConfig mapConfig = new MapConfig("sessions");
        config.addMapConfig(mapConfig);
        HazelcastInstance instance = Hazelcast.newHazelcastInstance(config);
        MapConfig noBackupsMap = new MapConfig("dont-backup").setBackupCount(0);
        instance.getConfig().addMapConfig(noBackupsMap);</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You must invoke the <code>add*Config</code> method on the Hazelcast instance&#8217;s configuration object to
add a configuration dynamically. In the above example, this is done with the
<code>instance.getConfig().addMapConfig(noBackupsMap);</code> line. This submits the map configuration dynamically
to all cluster members and also to members which join the cluster later.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dynamic configuration elements must be fully configured before the invocation
of <code>add*Config</code> method: at that point, the configuration object is delivered
to every member of the cluster and added to each member&#8217;s dynamic configuration,
so mutating the configuration object after the <code>add*Config</code> invocation does not have
an effect.</p>
</div>
<div class="paragraph">
<p>As dynamically added data structure configuration is propagated across all cluster
members, failures may occur due to conditions such as timeout and network partition.
The configuration propagation mechanism internally retries adding the configuration
whenever a membership change is detected. However if an exception is thrown from
<code>add*Config</code> method, the configuration may have been partially propagated to some
cluster members and adding the configuration should be retried by the user.</p>
</div>
<div class="paragraph">
<p>Adding a new dynamic configuration is supported for all <code>add*Config</code> methods except the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SplitBrainProtectionConfig</code>: A new split-brain protection configuration cannot be dynamically added but other
configuration can reference split-brain protections configured in the existing static configuration.</p>
</li>
<li>
<p><code>WanReplicationConfig</code>: A new WAN replication configuration cannot be dynamically
added, however existing static ones can be referenced from other configurations,
e.g., a new dynamic <code>MapConfig</code> may include a <code>WanReplicationRef</code> to a statically
configured WAN replication.</p>
</li>
<li>
<p><code>ListenerConfig</code>: Listeners can be instead added at runtime via other API such as
<code>HazelcastInstance.getCluster().addMembershipListener</code> and
<code>HazelcastInstance.getPartitionService().addMigrationListener</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Keep in mind that this feature also works for Hazelcast Java clients.
See the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HazelcastInstance client = HazelcastClient.newHazelcastClient();
MapConfig mCfg = new MapConfig("test");
mCfg.setTimeToLiveSeconds(15);
client.getConfig().addMapConfig(mCfg);
HazelcastClient.shutdownAll();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If your cluster has data structures with configurations added during runtime,
those configurations are lost when a cluster restart occurs due to any reason since
they are not persisted. This will be improved in future Hazelcast IMDG releases.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="handling-configuration-conflicts"><a class="anchor" href="#handling-configuration-conflicts"></a>Handling Configuration Conflicts</h3>
<div class="paragraph">
<p>Attempting to add a dynamic configuration, when a static configuration for
the same element already exists, throws <code>InvalidConfigurationException</code>. For example,
assuming we start a member with the following fragment in <code>hazelcast.xml</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;map name="sessions"&gt;
        ...
    &lt;/map&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then adding a dynamic configuration for a map with the name <code>sessions</code> throws
a <code>InvalidConfigurationException</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HazelcastInstance instance = Hazelcast.newHazelcastInstance();

MapConfig sessionsMapConfig = new MapConfig("sessions");

// this will throw ConfigurationException:
instance.getConfig().addMapConfig(sessionsMapConfig);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When attempting to add dynamic configuration for an element for which dynamic
configuration has already been added, then if a configuration conflict is detected
a <code>InvalidConfigurationException</code> is thrown. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HazelcastInstance instance = Hazelcast.newHazelcastInstance();

MapConfig sessionsMapConfig = new MapConfig("sessions").setBackupCount(0);
instance.getConfig().addMapConfig(sessionsMapConfig);

MapConfig sessionsWithBackup = new MapConfig("sessions").setBackupCount(1);
// throws ConfigurationException because the new MapConfig conflicts with existing one
instance.getConfig().addMapConfig(sessionsWithBackup);

MapConfig sessionsWithoutBackup = new MapConfig("sessions").setBackupCount(0);
// does not throw exception: new dynamic config is equal to existing dynamic config of same name
instance.getConfig().addMapConfig(sessionsWithoutBackup);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dynamic_data_structure_configuration_and_user_customizations"><a class="anchor" href="#_dynamic_data_structure_configuration_and_user_customizations"></a>Dynamic Data Structure Configuration and User Customizations</h3>
<div class="paragraph">
<p>Dynamically added data structure configuration may reference
user customizations, such as a user-provided <code>MapLoader</code> implementation referenced
by a <code>MapConfig</code>. User customizations can be usually configured using either of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by specifying a class or factory class name, e.g., <code>MapStoreConfig.setClassName</code>, and letting the
Hazelcast members instantiate the object</p>
</li>
<li>
<p>by providing an existing instance, e.g., <code>MapStoreConfig.setImplementation</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When dynamically adding new a data structure configuration with user customizations,
take the following considerations into account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the user customizations submitted as a class name or factory class name, the referenced
classes are resolved  lazily. Therefore, they should be either already on each member&#8217;s local
classpath or resolvable via <a href="#member-user-code-deployment">user code deployment</a>.</p>
</li>
<li>
<p>When the user customizations are submitted as instances (or similarly factory instances),
the instances themselves have to be serializable. This is because the entire configuration needs
to be sent over the network to all cluster members, and their classes have to be available
on each member&#8217;s local classpath.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="checking-configuration"><a class="anchor" href="#checking-configuration"></a>Checking Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you start a Hazelcast member without passing a <code>Config</code> object, as explained
in the <a href="#configuring-programmatically">Configuring Programmatically section</a>,
Hazelcast checks the member&#8217;s configuration as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, it looks for the <code>hazelcast.config</code> system property. If it is set, its
value is used as the path. This is useful if you want to be able to change your
Hazelcast configuration; you can do this because it is not embedded within the
application. You can set the <code>config</code> option with the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.config=`*`&lt;path to the hazelcast.xml or hazelcast.yaml&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The suffix of the filename is used to determine the language of the configuration.
If the suffix is <code>.xml</code> the
configuration file is parsed as an
XML configuration file. If it is <code>.yaml</code>, the configuration file is parsed as a
YAML configuration file.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The path can be a regular one or a classpath reference with the prefix <code>classpath:</code>.</p>
</div>
</li>
<li>
<p>If the above system property is not set, Hazelcast then checks whether there is
a <code>hazelcast.xml</code> file in the working directory.</p>
</li>
<li>
<p>If not, it then checks whether <code>hazelcast.xml</code> exists on the classpath.</p>
</li>
<li>
<p>If not, it then checks whether <code>hazelcast.yaml</code> (or <code>.yml</code>) exists in the working directory.</p>
</li>
<li>
<p>If not, it then checks whether <code>hazelcast.yaml</code> (or <code>.yml</code>) exists on the classpath.</p>
</li>
<li>
<p>If none of the above works, Hazelcast loads the default configuration
(<code>hazelcast.xml</code>) that comes with your Hazelcast package.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before configuring Hazelcast, please try to work with the default configuration
to see if it works for you. This default configuration should be fine for most of
the users. If not, you can consider to modify the configuration to be more suitable
for your environment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-pattern-matcher"><a class="anchor" href="#configuration-pattern-matcher"></a>Configuration Pattern Matcher</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can give a custom strategy to match an item name to a configuration pattern. By
default Hazelcast uses a simplified wildcard matching. See <a href="#using-wildcards">Using Wildcards section</a>
for this.
A custom configuration pattern matcher can be given by using either member or client <code>config</code>
objects, as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Setting a custom config pattern matcher via member config object
Config config = new Config();
config.setConfigPatternMatcher(new ExampleConfigPatternMatcher());</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the following is an example pattern matcher:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class ExampleConfigPatternMatcher extends MatchingPointConfigPatternMatcher {

    @Override
    public String matches(Iterable&lt;String&gt; configPatterns, String itemName) throws InvalidConfigurationException {
        String matches = super.matches(configPatterns, itemName);
        if (matches == null) throw new InvalidConfigurationException("No config found for " + itemName);
        return matches;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-wildcards"><a class="anchor" href="#using-wildcards"></a>Using Wildcards</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hazelcast supports wildcard configuration for all distributed data structures that
can be configured using <code>Config</code>, that is, for all except <code>IAtomicLong</code>,
<code>IAtomicReference</code>. Using an asterisk (*) character in the name, different
instances of maps, queues, topics, semaphores, etc. can be configured by a
single configuration.</p>
</div>
<div class="paragraph">
<p>A single asterisk (*) can be placed anywhere inside the configuration name.</p>
</div>
<div class="paragraph">
<p>For instance, a map named <code>com.hazelcast.test.mymap</code> can be configured using
one of the following configurations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;map name="com.hazelcast.test.*"&gt;
        ...
    &lt;/map&gt;

    &lt;!-- OR --&gt;

    &lt;map name="com.hazel*"&gt;
        ...
    &lt;/map&gt;

    &lt;!-- OR --&gt;

    &lt;map name="*.test.mymap"&gt;
        ...
    &lt;/map&gt;

    &lt;!-- OR --&gt;

    &lt;map name="com.*test.mymap"&gt;
        ...
    &lt;/map&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A queue named <code>com.hazelcast.test.myqueue</code> can be configured using one
of the following configurations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;queue name="*hazelcast.test.myqueue"&gt;
        ...
    &lt;/queue&gt;

    &lt;!-- OR --&gt;

    &lt;queue name="com.hazelcast.*.myqueue"&gt;
        ...
    &lt;/queue&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>You can use only a single asterisk as a wildcard for each data
structure configuration.</p>
</li>
<li>
<p>If you have matching wildcard configurations for a data structure,
the most specific (longest) one is used when configuring it. Let&#8217;s say
you have a map named <code>mymap.customer.name</code> and you have map configurations
<code>mymap.*</code> and <code>mymap.customer.*</code>. Hazelcast uses <code>mymap.customer.*</code> to
configure this map.</p>
<div class="paragraph">
<p>As another example, assume that you have a map named <code>mymap.customer.name</code>, and
map configurations <code>mymap.*.name</code> and <code>mymap.customer.*</code>. Hazelcast uses <code>mymap.customer.*</code>
to configure this map. As you see, the longest character length before the asterisk makes
it the most specific, so it wins the configuration.</p>
</div>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-variables"><a class="anchor" href="#using-variables"></a>Using Variables</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In your Hazelcast and/or Hazelcast Client declarative configuration, you can use
variables to set the values of the elements. This is valid when you set a system
property programmatically or you use the command line interface. You can use a variable
in the declarative configuration to access the values of the system properties you set.</p>
</div>
<div class="paragraph">
<p>For example, see the following command that sets two system properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dcluster.name=dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s get the values of these system properties in the declarative
configuration (XML/YAML) of Hazelcast, as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;cluster-name&gt;${cluster.name}&lt;/cluster-name&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  cluster-name: ${cluster.name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This also applies to the declarative configuration of Hazelcast Java Client,
as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast-client&gt;
    &lt;cluster-name&gt;${cluster.name}&lt;/cluster-name&gt;
&lt;/hazelcast-client&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast-client:
  cluster-name: ${cluster.name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not want to rely on the system properties, you can use the
<code>XmlConfigBuilder</code> or <code>YamlConfigBuilder</code> and explicitly
set a <code>Properties</code> instance, as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Properties properties = new Properties();

// fill the properties, e.g., from database/LDAP, etc.

XmlConfigBuilder builder = new XmlConfigBuilder();
builder.setProperties(properties);
Config config = builder.build();
HazelcastInstance hz = Hazelcast.newHazelcastInstance(config);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="variable-replacers"><a class="anchor" href="#variable-replacers"></a>Variable Replacers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Variable replacers are used to replace custom strings during loading the configuration,
e.g., they can be used to mask sensitive information such as usernames and passwords.
Of course their usage is not limited to security related information.</p>
</div>
<div class="paragraph">
<p>Variable replacers implement the interface <code>com.hazelcast.config.replacer.spi.ConfigReplacer</code>
and they are configured only
declaratively: in the Hazelcast&#8217;s declarative configuration files, i.e.,
<code>hazelcast.xml</code>, <code>hazelcast.yaml</code> and <code>hazelcast-client
.xml</code>, <code>hazelcast-client.yaml</code>. See the <code>ConfigReplacer</code>s
<a href="https://docs.hazelcast.org/docs/4.1/javadoc/com/hazelcast/config/replacer/spi/ConfigReplacer.html" target="_blank" rel="noopener">Javadoc</a>
for basic information on how a replacer works.</p>
</div>
<div class="paragraph">
<p>Variable replacers are configured within the element <code>&lt;config-replacers&gt;</code> under <code>&lt;hazelcast&gt;</code>,
as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;config-replacers fail-if-value-missing="false"&gt;
        &lt;replacer class-name="com.acme.MyReplacer"&gt;
            &lt;properties&gt;
                &lt;property name="propName"&gt;value&lt;/property&gt;
                ...
            &lt;/properties&gt;
        &lt;/replacer&gt;
        &lt;replacer class-name="example.AnotherReplacer"/&gt;
    &lt;/config-replacers&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
    ...
    config-replacers:
      fail-if-value-missing: false
      replacers:
        - class-name: com.acme.MyReplacer
          properties:
            propName: value
            ...
        - class-name: example.AnotherReplacer
    ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, <code>&lt;config-replacers&gt;</code> is the parent element for your replacers,
which are declared using the <code>&lt;replacer&gt;</code> sub-elements. You can define multiple
replacers under the <code>&lt;config-replacers&gt;.</code> Here are the descriptions of elements
and attributes used for the replacer configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>fail-if-value-missing</code>: Specifies whether the loading configuration process
stops when a replacement value is missing. It is an optional attribute and its default value is true.</p>
</li>
<li>
<p><code>class-name</code>: Full class name of the replacer.</p>
</li>
<li>
<p><code>&lt;properties&gt;</code>: Contains names and values of the properties used to configure a replacer.
Each property is defined using the <code>&lt;property&gt;</code> sub-element. All of the properties are
explained in the upcoming sections.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following replacer classes are provided by Hazelcast as example implementations of
the <code>ConfigReplacer</code> interface. Note that you can also implement your own replacers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EncryptionReplacer</code></p>
</li>
<li>
<p><code>PropertyReplacer</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There is also a <code>ExecReplacer</code> which runs an external command and uses its
standard output as the value for the variable. See its
<a href="https://github.com/hazelcast/hazelcast-code-samples/blob/master/variable-replacers/src/main/java/com/hazelcast/sample/replacer/ExecReplacer.java" target="_blank" rel="noopener">code sample</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each example replacer is explained in the below sections.</p>
</div>
<div class="sect2">
<h3 id="_encryptionreplacer"><a class="anchor" href="#_encryptionreplacer"></a>EncryptionReplacer</h3>
<div class="paragraph">
<p>This example <code>EncryptionReplacer</code> replaces encrypted variables by its plain
form. The secret key for encryption/decryption is generated from a password
which can be a value in a file and/or environment specific values, such as MAC
address and actual user data.</p>
</div>
<div class="paragraph">
<p>Its full class name is <code>com.hazelcast.config.replacer.EncryptionReplacer</code> and
the replacer prefix is <code>ENC</code>. The following are the properties used to
configure this example replacer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cipherAlgorithm</code>: Cipher algorithm used for the encryption/decryption.
Its default value is AES.</p>
</li>
<li>
<p><code>keyLengthBits</code>: Length of the secret key to be generated in bits. Its default value is 128 bits.</p>
</li>
<li>
<p><code>passwordFile</code>: Path to a file whose content should be used as a part
of the encryption password. When the property is not provided no file is
used as a part of the password. Its default value is null.</p>
</li>
<li>
<p><code>passwordNetworkInterface</code>: Name of network interface whose MAC address
should be used as a part of the encryption password. When the property is
not provided no network interface property is used as a part of the password.
Its default value is null.</p>
</li>
<li>
<p><code>passwordUserProperties</code>: Specifies whether the current user properties
(<code>user.name</code> and <code>user.home</code>) should be used as a part of the encryption
password. Its default value is true.</p>
</li>
<li>
<p><code>saltLengthBytes</code>: Length of a random password salt in bytes. Its default
value is 8 bytes.</p>
</li>
<li>
<p><code>secretKeyAlgorithm</code>:  Name of the secret-key algorithm to be associated
with the generated secret key. Its default value is AES.</p>
</li>
<li>
<p><code>secretKeyFactoryAlgorithm</code>: Algorithm used to generate a secret key from
a password. Its default value is PBKDF2WithHmacSHA256.</p>
</li>
<li>
<p><code>securityProvider</code>: Name of a Java Security Provider to be used for retrieving
the configured secret key factory and the cipher. Its default value is null.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Older Java versions may not support all the algorithms used as defaults.
Please use the property values supported your Java version.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a usage example, let&#8217;s create a password file and generate the encrypted
string out of this file as instructed below:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the password file: <code>echo '/Za-uG3dDfpd,5.-' &gt; /opt/master-password</code></p>
</li>
<li>
<p>Define the encrypted variables:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>java -cp hazelcast-*.jar \
    -DpasswordFile=/opt/master-password \
    -DpasswordUserProperties=false \
    com.hazelcast.config.replacer.EncryptionReplacer \
    "aCluster"
$ENC{Gw45stIlan0=:531:yVN9/xQpJ/Ww3EYkAPvHdA==}</code></pre>
</div>
</div>
</li>
<li>
<p>Configure the replacer and put the encrypted variables into the configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;config-replacers&gt;
        &lt;replacer class-name="com.hazelcast.config.replacer.EncryptionReplacer"&gt;
            &lt;properties&gt;
                &lt;property name="passwordFile"&gt;/opt/master-password&lt;/property&gt;
                &lt;property name="passwordUserProperties"&gt;false&lt;/property&gt;
            &lt;/properties&gt;
        &lt;/replacer&gt;
    &lt;/config-replacers&gt;
    &lt;cluster-name&gt;$ENC{Gw45stIlan0=:531:yVN9/xQpJ/Ww3EYkAPvHdA==}&lt;/cluster-name&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Check if the decryption works:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>java -jar hazelcast-*.jar
Apr 06, 2018 10:15:43 AM com.hazelcast.config.XmlConfigLocator
INFO: Loading 'hazelcast.xml' from working directory.
Apr 06, 2018 10:15:44 AM com.hazelcast.instance.AddressPicker
INFO: [LOCAL] [aCluster] [3.10-SNAPSHOT] Prefer IPv4 stack is true.</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>As you can see in the logs, the correctly decrypted cluster name value
("aCluster") is used.</p>
</div>
</div>
<div class="sect2">
<h3 id="_propertyreplacer"><a class="anchor" href="#_propertyreplacer"></a>PropertyReplacer</h3>
<div class="paragraph">
<p>The <code>PropertyReplacer</code> replaces variables by properties with the given
name. Usually the system properties are used, e.g., <code>${user.name}</code>.
There is no need to define it in the declarative configuration files.</p>
</div>
<div class="paragraph">
<p>Its full class name is <code>com.hazelcast.config.replacer.PropertyReplacer</code>
and the replacer prefix is empty string ("").</p>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_custom_replacers"><a class="anchor" href="#_implementing_custom_replacers"></a>Implementing Custom Replacers</h3>
<div class="paragraph">
<p>You can also provide your own replacer implementations. All replacers
have to implement the interface <code>com.hazelcast.config.replacer.spi.ConfigReplacer</code>.
A simple snippet is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ConfigReplacer {
    void init(Properties properties);
    String getPrefix();
    String getReplacement(String maskedValue);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<link rel="shortcut icon" href="http://hazelcast.com/images/favicon.png">
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/hazelcast/4.1/reference/understanding_configuration.html"></script>
<script async src="../../../_/../search-index.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
