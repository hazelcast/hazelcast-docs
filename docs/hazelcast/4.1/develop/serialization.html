<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Serialization Hazelcast Documentation</title>
    <link rel="canonical" href="https://jakescahill.github.io/docs-poc/hazelcast/4.1/develop/serialization.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-M267KFN"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','GTM-M267KFN')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://jakescahill.github.io/docs-poc">Hazelcast Documentation</a>
          <div class="navbar-item">
            <input id="search-input" type="text" placeholder="Search docs">
          </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Hazelcast Cloud</a>
            <a class="navbar-item" href="https://jakescahill.github.io/docs-poc/hazelcast/4.1/index.html">Hazelcast IMDG</a>
            <a class="navbar-item" href="#">Hazelcast Jet</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Learn</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://jakescahill.github.io/docs-poc/home/index.html">Docs</a>
            <a class="navbar-item" href="https://training.hazelcast.com/">Online Training</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Demos</a>
            <a class="navbar-item" href="#">Community</a>
            <a class="navbar-item" href="#">Blog</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Get Hazelcast</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="hazelcast" data-version="4.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../hazelcast_overview.html">Hazelcast IMDG</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../hazelcast_overview.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../get-started/getting_started.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-started/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="hazelcast_clients.html">Develop Solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jcache.html">JCache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="performance.html">Performance</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="serialization.html">Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="striim_cdc.html">Striim Hot Cache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributed_query.html">Distributed Query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributed_sql.html">Distributed SQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributed_events.html">Distributed Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributed_computing.html">Distributed Computing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../deploy/installing_upgrading.html">Deploy Clusters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/starting_members_clients.html">Starting Members and Clients</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/setting_up_clusters.html">Setting Up Clusters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/management.html">Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/simulator.html">Hazelcast Simulator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/wan.html">WAN Replication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/network_partitioning.html">Network Partitioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate/migration_guides.html">Migrate</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshoot/common_exception_types.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/faq.html">Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/dds.html">Distributed data structures</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/system_properties.html">System properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/understanding_configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/phone_homes.html">Phone homes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/hazelcast_plugins.html">Plugins</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../contribute/extending_hazelcast.html">Contribute</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/licenses.html">Licenses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/revision_history.html">Documentation changes</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Hazelcast IMDG</span>
    <span class="version">4.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Hazelcast Cloud</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hazelcast%20cloud/5/index.html">5</a>
        </li>
        <li class="version">
          <a href="../../../hazelcast%20cloud/4.1/index.html">4.1</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Hazelcast IMDG</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../hazelcast_overview.html">4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Hazelcast Jet</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hazelcast%20jet/4.1/index.html">4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Home</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../home/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../hazelcast_overview.html">Hazelcast IMDG</a></li>
    <li><a href="hazelcast_clients.html">Develop Solutions</a></li>
    <li><a href="serialization.html">Serialization</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a class="git" href="file:///C:/Users/Jake%20Cahill/Documents/code-playground/docs/hazelcast-docs/modules/develop/pages/serialization.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Serialization</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hazelcast needs to serialize the Java objects that you put into Hazelcast because
Hazelcast is a distributed system. The data and its replicas are
stored in different partitions on multiple cluster members.
The data you need may not be present on the local member, and in that case,
Hazelcast retrieves that data from another member. This requires serialization.</p>
</div>
<div class="paragraph">
<p>Serialization is used in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding key/value objects to a map</p>
</li>
<li>
<p>Putting items in a queue/set/list</p>
</li>
<li>
<p>Sending a runnable using an executor service</p>
</li>
<li>
<p>Processing an entry within a map</p>
</li>
<li>
<p>Locking an object</p>
</li>
<li>
<p>Sending a message to a topic</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hazelcast optimizes the serialization for the basic types and their array types.
You cannot override this behavior.</p>
</div>
<div class="paragraph">
<p>The following are the default types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Byte</code>, <code>Boolean</code>, <code>Character</code>, <code>Short</code>, <code>Integer</code>, <code>Long</code>, <code>Float</code>, <code>Double</code>, <code>String</code></p>
</li>
<li>
<p><code>byte[]</code>, <code>boolean[]</code>, <code>char[]</code>, <code>short[]</code>, <code>int[]</code>, <code>long[]</code>, <code>float[]</code>, <code>double[]</code>, <code>String[]</code></p>
</li>
<li>
<p><code>java.util.Date</code>, <code>java.math.BigInteger</code>, <code>java.math.BigDecimal</code>, <code>java.lang.Class</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hazelcast optimizes all of the above object types. You do not need to worry about their (de)serializations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serialization_interface_types"><a class="anchor" href="#_serialization_interface_types"></a>Serialization Interface Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For complex objects, use the following interfaces for serialization and deserialization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.io.Serializable</code>: See the <a href="#implementing-java-serializable-and-externalizable">Implementing Java Serializable and Externalizable section</a>.</p>
</li>
<li>
<p><code>java.io.Externalizable</code>: See the <a href="#implementing-java-externalizable">Implementing Java Externalizable section</a>.</p>
</li>
<li>
<p><code>com.hazelcast.nio.serialization.DataSerializable</code>: See the <a href="#implementing-dataserializable">Implementing DataSerializable section</a>.</p>
</li>
<li>
<p><code>com.hazelcast.nio.serialization.IdentifiedDataSerializable</code>: See the <a href="#identifieddataserializable">IdentifiedDataSerializable section</a>.</p>
</li>
<li>
<p><code>com.hazelcast.nio.serialization.Portable</code>: See the <a href="#implementing-portable-serialization">Implementing Portable Serialization section</a>.</p>
</li>
<li>
<p>Custom Serialization (using <a href="#implementing-streamserializer">StreamSerializer</a> and <a href="#implementing-bytearrayserializer">ByteArraySerializer</a>).</p>
</li>
<li>
<p>Global Serializer: See the <a href="#global-serializer">Global Serializer section</a> for details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When Hazelcast serializes an object:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It first checks whether the object is <code>null</code>.</p>
</li>
<li>
<p>If the above check fails, then Hazelcast checks if it is an instance of <code>com.hazelcast.nio.serialization.DataSerializable</code> or <code>com.hazelcast.nio.serialization.IdentifiedDataSerializable</code>.</p>
</li>
<li>
<p>If the above check fails, then Hazelcast checks if it is an instance of <code>com.hazelcast.nio.serialization.Portable</code>.</p>
</li>
<li>
<p>If the above check fails, then Hazelcast checks if it is an instance of one of
the default types (see the <a href="#serialization">Serialization chapter introduction</a> for default types).</p>
</li>
<li>
<p>If the above check fails, then Hazelcast looks for a user-specified <a href="#custom-serialization">Custom Serializer</a>,
i.e. an implementation of <code>ByteArraySerializer</code> or <code>StreamSerializer</code>.
Custom serializer is searched using the input Object&#8217;s Class and its parent class up to Object.
If parent class search fails, all interfaces implemented by the class are also checked (excluding <code>java.io.Serializable</code> and <code>java.io.Externalizable</code>).</p>
</li>
<li>
<p>If the above check fails, then Hazelcast checks if it is an instance of <code>java.io.Serializable</code> or
<code>java.io.Externalizable</code> and a Global Serializer is not registered with Java Serialization Override feature.</p>
</li>
<li>
<p>If the above check fails, Hazelcast uses the registered Global Serializer if one exists.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If all of the above checks fail, then serialization fails.
When a class implements multiple interfaces, the above steps are important
to determine the serialization mechanism that Hazelcast uses.
When a class definition is required for any of these serializations, you need to have
all the classes needed by the application on your classpath because Hazelcast does not
download them automatically, unless you are using <a href="#member-user-code-deployment">user code deployment</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_comparing_serialization_interfaces"><a class="anchor" href="#_comparing_serialization_interfaces"></a>Comparing Serialization Interfaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The table below provides a comparison between the interfaces listed in the previous section
to help you in deciding which interface to use in your applications.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 40%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Serialization Interface</th>
<th class="tableblock halign-left valign-top">Advantages</th>
<th class="tableblock halign-left valign-top">Drawbacks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serializable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>A standard and basic Java interface</p>
</li>
<li>
<p>Requires no implementation</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>More time and CPU usage</p>
</li>
<li>
<p>More space occupancy</p>
</li>
<li>
<p>Not supported by Native clients</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Externalizable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>A standard Java interface</p>
</li>
<li>
<p>More CPU and memory usage efficient than Serializable</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Serialization interface must be implemented</p>
</li>
<li>
<p>Not supported by Native clients</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataSerializable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>More CPU and memory usage efficient than Serializable</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Specific to Hazelcast</p>
</li>
<li>
<p>Not supported by Native clients</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IdentifiedDataSerializable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>More CPU and memory usage efficient than Serializable</p>
</li>
<li>
<p>Reflection is not used during deserialization</p>
</li>
<li>
<p>Supported by all Native Clients</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Specific to Hazelcast</p>
</li>
<li>
<p>Serialization interface must be implemented</p>
</li>
<li>
<p>A Factory and configuration must be implemented</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portable</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>More CPU and memory usage efficient than Serializable</p>
</li>
<li>
<p>Reflection is not used during deserialization</p>
</li>
<li>
<p>Versioning is supported</p>
</li>
<li>
<p>Partial deserialization is supported during Queries</p>
</li>
<li>
<p>Supported by all Native Clients</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Specific to Hazelcast</p>
</li>
<li>
<p>Serialization interface must be implemented</p>
</li>
<li>
<p>A Factory and configuration must be implemented</p>
</li>
<li>
<p>Class definition is also sent with data but stored only once per class</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom Serialization</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Does not require class to implement an interface</p>
</li>
<li>
<p>Convenient and flexible</p>
</li>
<li>
<p>Can be based on StreamSerializer ByteArraySerializer</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Serialization interface must be implemented</p>
</li>
<li>
<p>Plug in and configuration is required</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Let&#8217;s dig into the details of the above serialization mechanisms in the following sections.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_java_serializable_and_externalizable"><a class="anchor" href="#_implementing_java_serializable_and_externalizable"></a>Implementing Java Serializable and Externalizable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A class often needs to implement the <code>java.io.Serializable</code> interface; native Java serialization is the easiest way to do serialization.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at the example code below for Java Serializable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Employee implements Serializable {
    private static final long serialVersionUID = 1L;
    private String surname;

    public Employee( String surname ) {
        this.surname = surname;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the fields that are non-static and non-transient are automatically serialized.
To eliminate class compatibility issues, it is recommended that you add a <code>serialVersionUID</code>, as shown above.
Also, when you are using methods that perform byte-content comparisons, such as <code>IMap.replace()</code>,
and if byte-content of equal objects is different, you may face unexpected behaviors.
For example, if the class relies on a hash map, the <code>replace</code> method may fail.
The reason for this is the hash map is a serialized data structure with unreliable byte-content.</p>
</div>
<div class="sect2">
<h3 id="_implementing_java_externalizable"><a class="anchor" href="#_implementing_java_externalizable"></a>Implementing Java Externalizable</h3>
<div class="paragraph">
<p>Hazelcast also supports <code>java.io.Externalizable</code>. This interface offers more control
on the way fields are serialized or deserialized. Compared to native Java serialization,
it also can have a positive effect on performance. With <code>java.io.Externalizable</code>, there is no need to add <code>serialVersionUID</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a look at the example code below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Employee implements Externalizable {
    private String surname;
    public Employee(String surname) {
        this.surname = surname;
    }

    @Override
    public void readExternal( ObjectInput in )
      throws IOException, ClassNotFoundException {
        this.surname = in.readUTF();
    }

    @Override
    public void writeExternal( ObjectOutput out )
      throws IOException {
        out.writeUTF(surname);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You explicitly perform writing and reading of fields. Perform reading in the same order as writing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_dataserializable"><a class="anchor" href="#_implementing_dataserializable"></a>Implementing DataSerializable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned in <a href="#implementing-java-serializable-and-externalizable">Implementing Java Serializable &amp; Externalizable</a>,
Java serialization is an easy mechanism.
However, it does not control how fields are serialized or deserialized.
Moreover, Java serialization can lead to excessive CPU loads since it keeps track of
objects to handle the cycles and streams class descriptors. These are performance decreasing factors;
thus, serialized data may not have an optimal size.</p>
</div>
<div class="paragraph">
<p>The <code>DataSerializable</code> interface of Hazelcast overcomes these issues.
Here is an example of a class implementing the <code>com.hazelcast.nio.serialization.DataSerializable</code> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Address implements DataSerializable {
    private String street;
    private int zipCode;
    private String city;
    private String state;

    public Address() {}

    //getters setters..

    public void writeData( ObjectDataOutput out ) throws IOException {
        out.writeUTF(street);
        out.writeInt(zipCode);
        out.writeUTF(city);
        out.writeUTF(state);
    }

    public void readData( ObjectDataInput in ) throws IOException {
        street = in.readUTF();
        zipCode = in.readInt();
        city = in.readUTF();
        state = in.readUTF();
    }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_reading_and_writing_and_dataserializable"><a class="anchor" href="#_reading_and_writing_and_dataserializable"></a>Reading and Writing and DataSerializable</h3>
<div class="paragraph">
<p>Let&#8217;s take a look at another example which encapsulates a <code>DataSerializable</code> field.</p>
</div>
<div class="paragraph">
<p>Since the <code>address</code> field itself is <code>DataSerializable</code>, it calls <code>address.writeData(out)</code>
when writing and <code>address.readData(in)</code> when reading. Also note that you should have writing and reading of the fields occur
in the same order. When Hazelcast serializes a <code>DataSerializable</code>, it writes the <code>className</code> first.
When Hazelcast deserializes it, <code>className</code> is used to instantiate the object using reflection.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Employee implements DataSerializable {
    private String firstName;
    private String lastName;
    private int age;
    private double salary;
    private Address address; //address itself is DataSerializable

    public Employee() {}

    //getters setters..

    public void writeData( ObjectDataOutput out ) throws IOException {
        out.writeUTF(firstName);
        out.writeUTF(lastName);
        out.writeInt(age);
        out.writeDouble (salary);
        address.writeData (out);
    }

    public void readData( ObjectDataInput in ) throws IOException {
        firstName = in.readUTF();
        lastName = in.readUTF();
        age = in.readInt();
        salary = in.readDouble();
        address = new Address();
        // since Address is DataSerializable let it read its own internal state
        address.readData(in);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, since the <code>address</code> field itself is <code>DataSerializable</code>,
it calls <code>address.writeData(out)</code> when writing and <code>address.readData(in)</code> when reading.
Also note that you should have writing and reading of the fields occur in the same order.
While Hazelcast serializes a <code>DataSerializable</code>, it writes the <code>className</code> first.
When Hazelcast deserializes it, <code>className</code> is used to instantiate the object using reflection.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since Hazelcast needs to create an instance during the deserialization,<code>DataSerializable</code> class has a no-arg constructor.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>DataSerializable</code> is a good option if serialization is only needed for in-cluster communication.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>DataSerializable</code> is not supported by non-Java clients as it uses Java reflection.
If you need non-Java clients, please use <a href="#identifieddataserializable">IdentifiedDataSerializable</a> or
<a href="#implementing-portable-serialization">Portable</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_identifieddataserializable"><a class="anchor" href="#_identifieddataserializable"></a>IdentifiedDataSerializable</h3>
<div class="paragraph">
<p>For a faster serialization of objects, avoiding reflection and long class names,
Hazelcast recommends you implement <code>com.hazelcast.nio.serialization.IdentifiedDataSerializable</code>
which is a slightly better version of <code>DataSerializable</code>.</p>
</div>
<div class="paragraph">
<p><code>DataSerializable</code> uses reflection to create a class instance, as mentioned in
<a href="#implementing-dataserializable">Implementing DataSerializable</a>.
But <code>IdentifiedDataSerializable</code> uses a factory for this purpose and
it is faster during deserialization, which requires new instance creations.</p>
</div>
<div class="sect3">
<h4 id="_getclassid_and_getfactoryid_methods"><a class="anchor" href="#_getclassid_and_getfactoryid_methods"></a>getClassId and getFactoryId Methods</h4>
<div class="paragraph">
<p><code>IdentifiedDataSerializable</code> extends <code>DataSerializable</code> and introduces the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>int getClassId();</code></p>
</li>
<li>
<p><code>int getFactoryId();</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>IdentifiedDataSerializable</code> uses <code>getClassId()</code> instead of class name and it uses
<code>getFactoryId()</code> to load the class when given the id. To complete the implementation,
you should also implement  <code>com.hazelcast.nio.serialization.DataSerializableFactory</code> and
register it into <code>SerializationConfig</code>, which can be accessed from <code>Config.getSerializationConfig()</code>.
Factory&#8217;s responsibility is to return an instance of the right <code>IdentifiedDataSerializable</code> object, given the id.
This is currently the most efficient way of Serialization that Hazelcast supports off the shelf.</p>
</div>
</div>
<div class="sect3">
<h4 id="_implementing_identifieddataserializable"><a class="anchor" href="#_implementing_identifieddataserializable"></a>Implementing IdentifiedDataSerializable</h4>
<div class="paragraph">
<p>Let&#8217;s take a look at the following example code and configuration to see <code>IdentifiedDataSerializable</code> in action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Employee
    implements IdentifiedDataSerializable {

    private String surname;

    public Employee() {}

    public Employee( String surname ) {
        this.surname = surname;
    }

    @Override
    public void readData( ObjectDataInput in )
      throws IOException {
        this.surname = in.readUTF();
    }

    @Override
    public void writeData( ObjectDataOutput out )
      throws IOException {
        out.writeUTF( surname );
    }

    @Override
    public int getFactoryId() {
        return EmployeeDataSerializableFactory.FACTORY_ID;
    }

    @Override
    public int getClassId() {
        return EmployeeDataSerializableFactory.EMPLOYEE_TYPE;
    }

    @Override
    public String toString() {
        return String.format( "Employee(surname=%s)", surname );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods <code>getClassId</code> and <code>getFactoryId</code> return a unique positive number within
the <code>EmployeeDataSerializableFactory</code>.
Now, let&#8217;s create an instance of this <code>EmployeeDataSerializableFactory</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class EmployeeDataSerializableFactory
    implements DataSerializableFactory{

    public static final int FACTORY_ID = 1;

    public static final int EMPLOYEE_TYPE = 1;

    @Override
    public IdentifiedDataSerializable create(int typeId) {
        if ( typeId == EMPLOYEE_TYPE ) {
            return new Employee();
        } else {
            return null;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The only method you should implement is <code>create</code>, as seen in the above example.
It is recommended that you use a <code>switch-case</code> statement instead of
multiple <code>if-else</code> blocks if you have a lot of subclasses.
Hazelcast throws an exception if null is returned for <code>typeId</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_registering_employeedataserializablefactory"><a class="anchor" href="#_registering_employeedataserializablefactory"></a>Registering EmployeeDataSerializableFactory</h4>
<div class="paragraph">
<p>As the last step, you need to register <code>EmployeeDataSerializableFactory</code> declaratively
(declare in the configuration file <code>hazelcast.xml/yaml</code>) as shown below.
Note that <code>factory-id</code> has the same value of <code>FACTORY_ID</code> in the above code.
This is crucial to enable Hazelcast to find the correct factory.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;data-serializable-factories&gt;
            &lt;data-serializable-factory factory-id="1"&gt;
                EmployeeDataSerializableFactory
            &lt;/data-serializable-factory&gt;
        &lt;/data-serializable-factories&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    data-serializable-factories:
      - factory-id: 1
        class-name: EmployeeDataSerializableFactory</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the <a href="#serialization-configuration-wrap-up">Serialization Configuration Wrap-Up section</a>
for a full description of Hazelcast Serialization configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using a client/server deployment, you also need to register the implemented factory on
the client side. For a Java client, the process is the same as described above to be performed
in the client configuration, e.g., <code>hazelcast-client.xml/yaml</code>.
For the other Hazelcast clients, see the following for details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-csharp-client#41-identifieddataserializable-serialization" target="_blank" rel="noopener">.NET</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-cpp-client#41-identifieddataserializable-serialization" target="_blank" rel="noopener">C++</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-nodejs-client#41-identifieddataserializable-serialization" target="_blank" rel="noopener">Node.js</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-python-client#41-identifieddataserializable-serialization" target="_blank" rel="noopener">Python</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-go-client#41-identifieddataserializable-serialization" target="_blank" rel="noopener">Go</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_portable_serialization"><a class="anchor" href="#_implementing_portable_serialization"></a>Implementing Portable Serialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an alternative to the existing serialization methods, Hazelcast offers
a language/platform independent Portable serialization that has the following advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>support for multi-version of the same object type</p>
</li>
<li>
<p>fetching individual fields without having to rely on reflection</p>
</li>
<li>
<p>queries and indexing support without deserialization and/or reflection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to support these features, a serialized Portable object contains
meta information like the version and the concrete location of the each field in the binary data.
This way, Hazelcast navigates in the <code>byte[]</code> and deserializes only
the required field without actually deserializing the whole object.
This improves the Query performance.</p>
</div>
<div class="paragraph">
<p>With multi-version support, you can have two cluster members where
each has different versions of the same object. Hazelcast stores both
meta information and uses the correct one to serialize and deserialize Portable objects depending on the member.
This is very helpful when you are doing a rolling upgrade without shutting down the cluster.</p>
</div>
<div class="paragraph">
<p>Portable serialization is totally language independent and is used as
the binary protocol between Hazelcast server and clients.</p>
</div>
<div class="sect2">
<h3 id="_portable_serialization_example_code"><a class="anchor" href="#_portable_serialization_example_code"></a>Portable Serialization Example Code</h3>
<div class="paragraph">
<p>Here is example code for Portable implementation of a Foo class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Foo implements Portable {
    final static int ID = 5;

    private String foo;

    public String getFoo() {
        return foo;
    }

    public void setFoo( String foo ) {
        this.foo = foo;
    }

    @Override
    public int getFactoryId() {
        return 1;
    }

    @Override
    public int getClassId() {
        return ID;
    }

    @Override
    public void writePortable( PortableWriter writer ) throws IOException {
        writer.writeUTF( "foo", foo );
    }

    @Override
    public void readPortable( PortableReader reader ) throws IOException {
        foo = reader.readUTF( "foo" );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similar to <code>IdentifiedDataSerializable</code>, a Portable Class must provide <code>classId</code> and <code>factoryId</code>.
The Factory object creates the Portable object given the <code>classId</code>.</p>
</div>
<div class="paragraph">
<p>An example <code>Factory</code> could be implemented as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyPortableFactory implements PortableFactory {

    @Override
    public Portable create( int classId ) {
        if ( Foo.ID == classId )
        return new Foo();
        else
        return null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registering_the_portable_factory"><a class="anchor" href="#_registering_the_portable_factory"></a>Registering the Portable Factory</h3>
<div class="paragraph">
<p>The last step is to register the <code>Factory</code> to the <code>SerializationConfig</code>.
Below are the programmatic and declarative configurations for this step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config();
config.getSerializationConfig().addPortableFactory( 1, new MyPortableFactory() );</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;portable-version&gt;0&lt;/portable-version&gt;
        &lt;portable-factories&gt;
            &lt;portable-factory factory-id="1"&gt;
                com.hazelcast.examples.PortableFactory
            &lt;/portable-factory&gt;
        &lt;/portable-factories&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    portable-version: 0
    portable-factories:
      - factory-id: 1
        class-name: com.hazelcast.examples.PortableFactory</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>id</code> that is passed to the <code>SerializationConfig</code> is the same
as the <code>factoryId</code> that the <code>Foo</code> class returns.</p>
</div>
<div class="paragraph">
<p>When using a client/server deployment, you also need to register the implemented factory on
the client side. For a Java client, the process is the same as described above to be performed
in the client configuration, e.g., <code>hazelcast-client.xml/yaml</code>.
For the other Hazelcast clients, see the following for details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-csharp-client#42-portable-serialization" target="_blank" rel="noopener">.NET</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-cpp-client#42-portable-serialization" target="_blank" rel="noopener">C++</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-nodejs-client#42-portable-serialization" target="_blank" rel="noopener">Node.js</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-python-client#42-portable-serialization" target="_blank" rel="noopener">Python</a></p>
</li>
<li>
<p><a href="https://github.com/hazelcast/hazelcast-go-client#42-portable-serialization" target="_blank" rel="noopener">Go</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_versioning_for_portable_serialization"><a class="anchor" href="#_versioning_for_portable_serialization"></a>Versioning for Portable Serialization</h3>
<div class="paragraph">
<p>More than one version of the same class may need to be serialized and deserialized.
For example, a client may have an older version of a class and the member to which
it is connected may have a newer version of the same class.</p>
</div>
<div class="paragraph">
<p>Portable serialization supports versioning.
It is a global versioning, meaning that all portable classes that
are serialized through a member get the globally configured portable version.</p>
</div>
<div class="paragraph">
<p>You can declare the version in the XML or YAML configuration file using
the <code>portable-version</code> element, as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;portable-version&gt;1&lt;/portable-version&gt;
        &lt;portable-factories&gt;
            &lt;portable-factory factory-id="1"&gt;
                PortableFactoryImpl
            &lt;/portable-factory&gt;
        &lt;/portable-factories&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    portable-version: 1
    portable-factories:
      - factory-id: 1
        class-name: PortableFactoryImpl</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use the interface
<a href="https://docs.hazelcast.org/docs/4.1/javadoc/com/hazelcast/nio/serialization/VersionedPortable.html" target="_blank" rel="noopener">VersionedPortable</a>
which enables to upgrade the version per class, instead of global versioning.
If you need to update only one class, you can use this interface.
In this case, your class should implement <code>VersionedPortable</code> instead of <code>Portable</code>,
and you can give the desired version using the method <code>VersionedPortable.getClassVersion()</code>.</p>
</div>
<div class="paragraph">
<p>You should consider the following when you perform versioning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is important to change the version whenever an update is performed
in the serialized fields of a class, for example by incrementing the version.</p>
</li>
<li>
<p>If a client performs a Portable deserialization on a field and then
that Portable is updated by removing that field on the cluster side, this may lead to a problem.</p>
</li>
<li>
<p>Portable serialization does not use reflection and hence,
fields in the class and in the serialized content are not automatically mapped.
Field renaming is a simpler process. Also, since the class ID is stored,
renaming the Portable does not lead to problems.</p>
</li>
<li>
<p>Types of fields need to be updated carefully.
Hazelcast performs basic type upgradings, such as <code>int</code> to <code>float</code>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_example_portable_versioning_scenarios"><a class="anchor" href="#_example_portable_versioning_scenarios"></a>Example Portable Versioning Scenarios</h4>
<div class="paragraph">
<p>Assume that a new member joins to the cluster with a class that
has been modified and class' version has been upgraded due to this modification.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you modified the class by adding a new field, the new member&#8217;s <code>put</code>
operations include that new field. If this new member tries to get an object that
was put from the older members, it gets <code>null</code> for the newly added field.</p>
</li>
<li>
<p>If you modified the class by removing a field, the old members get <code>null</code> for the objects that are put by the new member.</p>
</li>
<li>
<p>If you modified the class by changing the type of a field, the error <code>IncompatibleClassChangeError</code>
is generated unless the change was made on a built-in type or
the byte size of the new type is less than or equal to the old one.
The following are examples of allowed type conversions:</p>
<div class="ulist">
<ul>
<li>
<p><code>long</code> &#8594; <code>int</code>, <code>byte</code>, <code>char</code>, <code>short</code></p>
</li>
<li>
<p><code>int</code>&#8594; <code>byte</code>, <code>char</code>, <code>short</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you have not modify a class at all, it works as usual.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ordering_consistency_for_writeportable"><a class="anchor" href="#_ordering_consistency_for_writeportable"></a>Ordering Consistency for <code>writePortable</code></h3>
<div class="paragraph">
<p>Independent of the member-member or member-client communications, the method <code>writePortable()</code> of
the classes that implement <code>Portable</code> should be consistent.
This means, the fields listed under the method <code>writePortable()</code> should be
in the same order for all involved members and/or clients.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s consider the following <code>Employee</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class EmployeePortable implements Portable {

    private String name;
    private int age;

    public EmployeePortable() {
    }

    public EmployeePortable(int age, String name) {
        this.age = age;
        this.name = name;
    }

    public int getFactoryId() {
        return 666;
    }

    public int getClassId() {
        return 2;
    }

    public void writePortable(PortableWriter writer) throws IOException {
        writer.writeUTF("n", name);
        writer.writeInt("a", age);
    }

    public void readPortable(PortableReader reader) throws IOException {
        name = reader.readUTF("n");
        age = reader.readInt("a");
    }

    public int getAge() {
        return age;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you see in the above example, first the <code>name</code> and then the <code>age</code> is written.
This order should be preserved in other members or clients.</p>
</div>
</div>
<div class="sect2">
<h3 id="_null_portable_serialization"><a class="anchor" href="#_null_portable_serialization"></a>Null Portable Serialization</h3>
<div class="paragraph">
<p>Be careful with serializing null portables. Hazelcast lazily creates a class definition of portable internally
when the user first serializes. This class definition is stored and used later for deserializing that portable class. When
the user tries to serialize a null portable when there is no class definition at the moment, Hazelcast throws an
exception saying that <code>com.hazelcast.nio.serialization.HazelcastSerializationException: Cannot write null portable
without explicitly registering class definition!</code>.</p>
</div>
<div class="paragraph">
<p>There are two solutions to get rid of this exception. Either put
a non-null portable class of the same type before any other operation,
or manually register a class definition in serialization configuration as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config();
final ClassDefinition classDefinition = new ClassDefinitionBuilder(Foo.factoryId, Foo.getClassId)
                       .addUTFField("foo").build();
config.getSerializationConfig().addClassDefinition(classDefinition);
Hazelcast.newHazelcastInstance(config);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_distributedobject_serialization"><a class="anchor" href="#_distributedobject_serialization"></a>DistributedObject Serialization</h3>
<div class="paragraph">
<p>Putting a <code>DistributedObject</code> (Hazelcast Semaphore, Queue, etc.) in a cluster member and
getting it from another one is not a straightforward operation.
Passing the ID and type of the <code>DistributedObject</code> can be a solution.
For deserialization, you can get the object from HazelcastInstance.
For instance, if your object is an instance of <code>IQueue</code>, you can either use
<code>HazelcastInstance.getQueue(id)</code> or <code>Hazelcast.getDistributedObject</code>.</p>
</div>
<div class="paragraph">
<p>You can use the <code>HazelcastInstanceAware</code> interface in the case of
a deserialization of a Portable <code>DistributedObject</code> if it gets an ID to be looked up.
HazelcastInstance is set after deserialization, so you first need to store the ID and
then retrieve the <code>DistributedObject</code> using the <code>setHazelcastInstance</code> method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the <a href="#serialization-configuration-wrap-up">Serialization Configuration Wrap-Up section</a>
for a full description of Hazelcast Serialization configuration elements.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_custom_serialization"><a class="anchor" href="#_custom_serialization"></a>Custom Serialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hazelcast lets you plug in a custom serializer for serializing your objects.
You can use <a href="#implementing-streamserializer">StreamSerializer</a> and
<a href="#implementing-bytearrayserializer">ByteArraySerializer</a> interfaces for this purpose.</p>
</div>
<div class="sect2">
<h3 id="_implementing_streamserializer"><a class="anchor" href="#_implementing_streamserializer"></a>Implementing StreamSerializer</h3>
<div class="paragraph">
<p>You can use a stream to serialize and deserialize data by using <code>StreamSerializer</code>.
This is a good option for your own implementations.
It can also be adapted to external serialization libraries like Kryo, JSON and protocol buffers.</p>
</div>
<div class="sect3">
<h4 id="_streamserializer_example_code_1"><a class="anchor" href="#_streamserializer_example_code_1"></a>StreamSerializer Example Code 1</h4>
<div class="paragraph">
<p>First, let&#8217;s create a simple object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class EmployeeSS {
    private String surname;
    private String name;

    public EmployeeSS( String surname ) {
        this.surname = surname;
    }

    public String getSurname() {
        return surname;
    }
    public String getName() {
        return name;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s implement StreamSerializer for <code>Employee</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class EmployeeStreamSerializer
        implements StreamSerializer&lt;EmployeeSS&gt; {

    @Override
    public int getTypeId () {
        return 1;
    }

    @Override
    public void write( ObjectDataOutput out, EmployeeSS employee )
            throws IOException {
        out.writeUTF(employee.getSurname());
    }

    @Override
    public EmployeeSS read( ObjectDataInput in )
            throws IOException {
        String surname = in.readUTF();
        return new EmployeeSS(surname);
    }

    @Override
    public void destroy () {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In practice, classes may have many fields.
Just make sure the fields are read in the same order as they are written.
The type ID must be unique and greater than or equal to <strong>1</strong>.
Uniqueness of the type ID enables Hazelcast to determine which serializer is used during deserialization.</p>
</div>
<div class="paragraph">
<p>As the last step, let&#8217;s register the <code>EmployeeStreamSerializer</code> in
the configuration file <code>hazelcast.xml/yaml</code>, as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;serializers&gt;
            &lt;serializer type-class="EmployeeSS" class-name="EmployeeStreamSerializer" /&gt;
        &lt;/serializers&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    serializers:
      - type-class: EmployeeSS
        class-name: EmployeeStreamSerializer</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>StreamSerializer</code> cannot be created for well-known types, such as Long and String and primitive arrays.
Hazelcast already registers these types.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_streamserializer_example_code_2"><a class="anchor" href="#_streamserializer_example_code_2"></a>StreamSerializer Example Code 2</h4>
<div class="paragraph">
<p>Let&#8217;s take a look at another example implementing <code>StreamSerializer</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Foo {
    private String foo;

    public String getFoo() {
        return foo;
    }

    public void setFoo( String foo ) {
        this.foo = foo;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assume that our custom serialization serializes
Foo into XML. First you need to implement a
<code>com.hazelcast.nio.serialization.StreamSerializer</code>.
A very simple one that uses XMLEncoder and XMLDecoder could look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class FooXmlSerializer implements StreamSerializer&lt;Foo&gt; {

    @Override
    public int getTypeId() {
        return 10;
    }

    public void write( ObjectDataOutput out, Foo object ) throws IOException {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        XMLEncoder encoder = new XMLEncoder( bos );
        encoder.writeObject( object );
        encoder.close();
        out.write( bos.toByteArray() );
    }

    public Foo read( ObjectDataInput in ) throws IOException {
        InputStream inputStream = (InputStream) in;
        XMLDecoder decoder = new XMLDecoder( inputStream );
        return (Foo) decoder.readObject();
    }

    public void destroy() {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_streamserializer"><a class="anchor" href="#_configuring_streamserializer"></a>Configuring StreamSerializer</h4>
<div class="paragraph">
<p>Note that <code>typeId</code> must be unique because Hazelcast uses it to
look up the <code>StreamSerializer</code> while it deserializes the object.
The last required step is to register the <code>StreamSerializer</code> in your Hazelcast configuration.
Below are the programmatic and declarative configurations for this step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">SerializerConfig sc = new SerializerConfig()
    .setImplementation(new FooXmlSerializer())
    .setTypeClass(Foo.class);
Config config = new Config();
config.getSerializationConfig().addSerializerConfig(sc);</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;serialization&gt;
        &lt;serializers&gt;
            &lt;serializer type-class="com.www.Foo" class-name="com.www.FooXmlSerializer" /&gt;
        &lt;/serializers&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    serializers:
      - type-class: com.www.Foo
        class-name: com.www.FooXmlSerializer</code></pre>
</div>
</div>
<div class="paragraph">
<p>From now on, this Hazelcast example will use <code>FooXmlSerializer</code>
to serialize Foo objects. In this way, you can write an adapter (StreamSerializer) for any
Serialization framework and plug it into Hazelcast.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the <a href="#serialization-configuration-wrap-up">Serialization Configuration Wrap-Up section</a>
for a full description of Hazelcast Serialization configuration elements.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_bytearrayserializer"><a class="anchor" href="#_implementing_bytearrayserializer"></a>Implementing ByteArraySerializer</h3>
<div class="paragraph">
<p><code>ByteArraySerializer</code> exposes the raw ByteArray used internally by Hazelcast.
It is a good option if the serialization library you are using deals with ByteArrays instead of streams.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s implement <code>ByteArraySerializer</code> for the <code>Employee</code> class mentioned in
<a href="#implementing-streamserializer">Implementing StreamSerializer</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class EmployeeByteArraySerializer
        implements ByteArraySerializer&lt;EmployeeSS&gt; {

    @Override
    public void destroy () {
    }

    @Override
    public int getTypeId () {
        return 1;
    }

    @Override
    public byte[] write( EmployeeSS object )
            throws IOException {
        return object.getName().getBytes();
    }

    @Override
    public EmployeeSS read( byte[] buffer )
            throws IOException {
        String surname = new String( buffer );
        return new EmployeeSS( surname );
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_bytearrayserializer"><a class="anchor" href="#_configuring_bytearrayserializer"></a>Configuring ByteArraySerializer</h4>
<div class="paragraph">
<p>As usual, let&#8217;s register the <code>EmployeeByteArraySerializer</code> in the configuration file <code>hazelcast.xml/yaml</code>, as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;serializers&gt;
            &lt;serializer type-class="Employee"&gt;EmployeeByteArraySerializer&lt;/serializer&gt;
        &lt;/serializers&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    serializers:
      - type-class: Employee
        class-name: EmployeeByteArraySerializer</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
See the <a href="#serialization-configuration-wrap-up">Serialization Configuration Wrap-Up section</a>
for a full description of Hazelcast Serialization configuration elements.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_global_serializer"><a class="anchor" href="#_global_serializer"></a>Global Serializer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The global serializer is identical to
<a href="#custom-serialization">custom serializers</a> from the implementation perspective.
The global serializer is registered as a fallback serializer to handle all other objects if a serializer cannot be located for them.</p>
</div>
<div class="paragraph">
<p>By default, the global serializer does not handle <code>java.io.Serializable</code> and <code>java.io.Externalizable</code> instances.
However, you can configure it to be responsible for those instances.</p>
</div>
<div class="paragraph">
<p>A custom serializer should be registered for a specific class type.
The global serializer handles all class types if all the steps in searching for
a serializer fail as described in <a href="#serialization-interface-types">Serialization Interface Types</a>.</p>
</div>
<div class="paragraph">
<p>The following are some use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Third party serialization frameworks can be integrated using the global serializer.</p>
</li>
<li>
<p>For your custom objects, you can implement a single serializer to handle all of them.</p>
</li>
<li>
<p>You can replace the internal Java serialization by enabling the
<code>overrideJavaSerialization</code> option of the global serializer configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any custom serializer can be used as the global serializer.
See the <a href="#custom-serialization">Custom Serialization section</a> for implementation details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To function properly, Hazelcast needs the Java serializable objects to be handled correctly.
If the global serializer is configured to handle the Java serialization, the global serializer must
properly serialize/deserialize the <code>java.io.Serializable</code> instances. Otherwise, it causes Hazelcast to malfunction.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="sample-global-serializer"><a class="anchor" href="#sample-global-serializer"></a>Example Global Serializer</h3>
<div class="paragraph">
<p>An example global serializer that integrates with a third party serializer is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GlobalStreamSerializer
    implements StreamSerializer&lt;Object&gt; {

    private SomeThirdPartySerializer someThirdPartySerializer;

    private init() {
        //someThirdPartySerializer  = ...
    }

    @Override
    public int getTypeId () {
        return 123;
    }

    @Override
    public void write( ObjectDataOutput out, Object object ) throws IOException {
        byte[] bytes = someThirdPartySerializer.encode(object);
        out.writeByteArray(bytes);
    }

    @Override
    public Object read( ObjectDataInput in ) throws IOException {
        byte[] bytes = in.readByteArray();
        return someThirdPartySerializer.decode(bytes);
    }

    @Override
    public void destroy () {
        someThirdPartySerializer.destroy();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, we can register the global serializer in the configuration file <code>hazelcast.xml/yaml</code>, as shown below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;serializers&gt;
            &lt;global-serializer override-java-serialization="true"&gt;GlobalStreamSerializer&lt;/global-serializer&gt;
        &lt;/serializers&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    global-serializer:
      override-java-serialization: true
      class-name: GlobalStreamSerializer</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementing_hazelcastinstanceaware"><a class="anchor" href="#_implementing_hazelcastinstanceaware"></a>Implementing HazelcastInstanceAware</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can implement the <code>HazelcastInstanceAware</code> interface to access
distributed objects for cases where an object is deserialized and needs access to HazelcastInstance.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s implement it for the <code>Employee</code> class mentioned in the
<a href="#custom-serialization">Custom Serialization section</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonAwr implements Serializable, HazelcastInstanceAware {

    private static final long serialVersionUID = 1L;

    private String name;

    private transient HazelcastInstance hazelcastInstance;

    PersonAwr(String name) {
        this.name = name;
    }

    public HazelcastInstance getHazelcastInstance() {
        return hazelcastInstance;
    }

    @Override
    public void setHazelcastInstance(HazelcastInstance hz) {
        this.hazelcastInstance = hz;
        System.out.println("hazelcastInstance set");
    }

    @Override
    public String toString() {
        return String.format("Person(name=%s)", name);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After deserialization, the object is checked to see if it implements
<code>HazelcastInstanceAware</code> and the method <code>setHazelcastInstance</code> is called.
Notice the <code>hazelcastInstance</code> is <code>transient</code>. This is because this field should not be serialized.</p>
</div>
<div class="paragraph">
<p>It may be a good practice to inject a HazelcastInstance into a domain object,
e.g., <code>Employee</code> in the above example, when used together with <code>Runnable</code>/<code>Callable</code> implementations.
These runnables/callables are executed by <code>IExecutorService</code> which sends them to another machine.
And after a task is deserialized, run/call method implementations need to access HazelcastInstance.</p>
</div>
<div class="paragraph">
<p>We recommend you only set the HazelcastInstance field while using
<code>setHazelcastInstance</code> method and you not execute operations on the HazelcastInstance.
The reason is that when HazelcastInstance is injected for a <code>HazelcastInstanceAware</code> implementation,
it may not be up and running at the injection time.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_untrusted_deserialization_protection"><a class="anchor" href="#_untrusted_deserialization_protection"></a>Untrusted Deserialization Protection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hazelcast offers a Java deserialization protection based on whitelisting and blacklisting the class/package names.
These listings support prefixes.</p>
</div>
<div class="paragraph">
<p>This protection is controlled using the configuration element <code>java-serialization-filter</code> under <code>serialization</code>,
as shown in the example below.</p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    ...
    &lt;serialization&gt;
        &lt;java-serialization-filter defaults-disabled="true"&gt;
            &lt;whitelist&gt;
		&lt;class&gt;example.Foo&lt;/class&gt;
		&lt;package&gt;com.acme.app&lt;/package&gt;
		&lt;prefix&gt;com.hazelcast.&lt;/prefix&gt;
		&lt;prefix&gt;java.&lt;/prefix&gt;
		&lt;prefix&gt;javax.&lt;/prefix&gt;
		&lt;prefix&gt;[&lt;/prefix&gt;
            &lt;/whitelist&gt;
            &lt;blacklist&gt;
                &lt;class&gt;com.acme.app.BeanComparator&lt;/class&gt;
            &lt;/blacklist&gt;
        &lt;/java-serialization-filter&gt;
    &lt;/serialization&gt;
    ...
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    java-serialization-filter:
      defaults-disabled: true
      whitelist:
        class:
          - example.Foo
        package:
          - com.acme.app
        prefix:
          - com.hazelcast.
          - java.
          - javax.
          - [
      blacklist:
        class:
          - com.acme.app.BeanComparator</code></pre>
</div>
</div>
<div class="paragraph">
<p>As an alternative, you can also configure it programmatically using
the <code>JavaSerializationFilterConfig</code> object, as shown in the below example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config();
JavaSerializationFilterConfig javaSerializationFilterConfig = new JavaSerializationFilterConfig();
javaSerializationFilterConfig.getWhitelist().addClasses(SomeDeserialized.class.getName());
config.getSerializationConfig().setJavaSerializationFilterConfig(javaSerializationFilterConfig);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Untrusted deserialization protection is not enabled by default.
You can enable it simply by setting the element <code>java-serialization-filter</code> or
using a non-null <code>JavaSerializationFilterConfig</code> object.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The protection uses a whitelist as the default configuration.
When this list is not explicitly provided, the following default prefixes are used for the whitelist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java</code></p>
</li>
<li>
<p><code>com.hazelcast.</code></p>
</li>
<li>
<p><code>[</code> (for primitives and arrays)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you do not want to use the default whitelist prefixes, you must set the <code>defaults-disabled</code> attribute to true.</p>
</div>
<div class="paragraph">
<p>Once the protection is enabled, the following filtering rules are used when the objects are deserialized:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When whitelist is not provided:</p>
<div class="ulist">
<ul>
<li>
<p>if the deserialized object&#8217;s <code>getClass().getName()</code> is blacklisted or
<code>getClass().getPackage().getName()</code> is blacklisted, then deserialization fails</p>
</li>
<li>
<p>deserialization is allowed otherwise.</p>
</li>
</ul>
</div>
</li>
<li>
<p>When whitelist is provided:</p>
<div class="ulist">
<ul>
<li>
<p>if the deserialized object&#8217;s <code>getClass().getName()</code> or
<code>getClass().getPackage().getName()</code> is blacklisted, then deserialization fails</p>
</li>
<li>
<p>if the deserialized object&#8217;s <code>getClass().getName()</code> or
<code>getClass().getPackage().getName()</code> is whitelisted, then deserialization is allowed</p>
</li>
<li>
<p>deserialization fails otherwise.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When deserialization fails, a <code>SecurityException</code> is thrown.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note that the safest way to provide a protection against
untrusted deserialization is using whitelisting (also keep in mind that maintaining such a whitelist can be difficult).
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_serialization_configuration_wrap_up"><a class="anchor" href="#_serialization_configuration_wrap_up"></a>Serialization Configuration Wrap-Up</h3>
<div class="paragraph">
<p>This section summarizes the configuration of serialization options, explained in the above sections,
into all-in-one examples. The following are example serialization configurations.</p>
</div>
<div class="paragraph">
<p><strong>Declarative Configuration:</strong></p>
</div>
<div class="listingblock primary">
<div class="title">XML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;hazelcast&gt;
    &lt;serialization&gt;
        &lt;portable-version&gt;0&lt;/portable-version&gt;
        &lt;use-native-byte-order&gt;false&lt;/use-native-byte-order&gt;
        &lt;byte-order&gt;BIG_ENDIAN&lt;/byte-order&gt;
        &lt;data-serializable-factories&gt;
            &lt;data-serializable-factory factory-id="1"&gt;com.hazelcast.examples.DataSerializableFactory
            &lt;/data-serializable-factory&gt;
        &lt;/data-serializable-factories&gt;
        &lt;portable-factories&gt;
            &lt;portable-factory factory-id="1"&gt;com.hazelcast.examples.PortableFactory&lt;/portable-factory&gt;
        &lt;/portable-factories&gt;
        &lt;serializers&gt;
            &lt;global-serializer&gt;com.hazelcast.examples.GlobalSerializerFactory&lt;/global-serializer&gt;
            &lt;serializer type-class="com.hazelcast.examples.DummyType"
                        class-name="com.hazelcast.examples.SerializerFactory"/&gt;
        &lt;/serializers&gt;
        &lt;check-class-def-errors&gt;true&lt;/check-class-def-errors&gt;
        &lt;java-serialization-filter defaults-disabled="true"&gt;
            &lt;blacklist&gt;
                &lt;class&gt;com.acme.app.BeanComparator&lt;/class&gt;
            &lt;/blacklist&gt;
            &lt;whitelist&gt;
                &lt;class&gt;java.lang.String&lt;/class&gt;
                &lt;class&gt;example.Foo&lt;/class&gt;
                &lt;package&gt;com.acme.app&lt;/package&gt;
                &lt;package&gt;com.acme.app.subpkg&lt;/package&gt;
                &lt;prefix&gt;com.hazelcast.&lt;/prefix&gt;
                &lt;prefix&gt;java&lt;/prefix&gt;
            &lt;/whitelist&gt;
        &lt;/java-serialization-filter&gt;
    &lt;/serialization&gt;
&lt;/hazelcast&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">YAML</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">hazelcast:
  serialization:
    portable-version: 0
    use-native-byte-order: false
    byte-order: BIG_ENDIAN
    data-serializable-factories:
      - factory-id: 1
        class-name: com.hazelcast.examples.DataSerializableFactory
    portable-factories:
      - factory-id: 1
        class-name: com.hazelcast.examples.PortableFactory
    global-serializer:
      class-name: com.hazelcast.examples.GlobalSerializerFactory
    serializers:
      - type-class: com.hazelcast.examples.DummyType
        class-name: com.hazelcast.examples.SerializerFactory
    check-class-def-errors: true
    java-serialization-filter:
      defaults-disabled: true
      blacklist:
        class:
          - com.acme.app.BeanComparator
      whitelist:
        class:
          - java.lang.String
          - example.Foo
        package:
          - com.acme.app
          - com.acme.app.subpkg
        prefix:
          - com.hazelcast.
          - java</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Programmatic Configuration:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Config config = new Config();
SerializationConfig srzConfig = config.getSerializationConfig();
srzConfig.setPortableVersion( "2" ).setUseNativeByteOrder( true );
srzConfig.setAllowUnsafe( true ).setEnableCompression( true );
srzConfig.setCheckClassDefErrors( true );

GlobalSerializerConfig globSrzConfig = srzConfig.getGlobalSerializerConfig();
globSrzConfig.setClassName( "abc.Class" );

SerializerConfig serializerConfig = srzConfig.getSerializerConfig();
serializerConfig.setTypeClass( "Employee" )
                .setClassName( "com.EmployeeSerializer" );</code></pre>
</div>
</div>
<div class="paragraph">
<p>Serialization configuration has the following elements.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>portable-version</code>: Defines versioning of the portable serialization.
Portable version differentiates two of the same classes that have changes, such as adding/removing field or
changing a type of a field.</p>
</li>
<li>
<p><code>use-native-byte-order</code>: Set to <code>true</code> to use native byte order for the underlying platform.
Its default value is <code>false</code>.</p>
</li>
<li>
<p><code>byte-order</code>: Defines the byte order that the serialization uses: <code>BIG_ENDIAN</code> or <code>LITTLE_ENDIAN</code>.
Its default value is <code>BIG_ENDIAN</code>.</p>
</li>
<li>
<p><code>enable-compression</code>: Enables compression if default Java serialization is used.
Its default value is <code>false</code>.</p>
</li>
<li>
<p><code>enable-shared-object</code>: Enables shared object if default Java serialization is used.
Its default value is <code>false</code>.</p>
</li>
<li>
<p><code>allow-unsafe</code>: Set to <code>true</code> to allow <code>unsafe</code> to be used.
Its default value is <code>false</code>.</p>
</li>
<li>
<p><code>data-serializable-factory</code>: Custom classes implementing
<code>com.hazelcast.nio.serialization.DataSerializableFactory</code> to be registered.
These can be used to speed up serialization/deserialization of objects.</p>
</li>
<li>
<p><code>portable-factory</code>: The <code>PortableFactory</code> class to be registered.</p>
</li>
<li>
<p><code>global-serializer</code>: The global serializer class to be registered if no other serializer is applicable.
This element has the optional boolean attribute <code>override-java-serialization</code>.
If set to <code>true</code>, the Java serialization step is assumed to be handled by the global serializer.
Java Serializable and Externalizable is prior to global serializer by default (<code>false</code>).</p>
</li>
<li>
<p><code>serializer</code>: The class name of the serializer implementation.</p>
</li>
<li>
<p><code>check-class-def-errors</code>: When set to <code>true</code>, the serialization system checks for
class definitions error at start and throws a Serialization Exception with an error definition.</p>
</li>
<li>
<p><code>java-serialization-filter</code>: Provides deserialization protection based on
whitelisting and blacklisting the class/package names.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<link rel="shortcut icon" href="http://hazelcast.com/images/favicon.png">
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/hazelcast/4.1/develop/serialization.html"></script>
<script async src="../../../_/../search-index.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
